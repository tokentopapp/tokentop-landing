---
const installMethods = [
  {
    name: "Homebrew",
    command: "brew install tokentopapp/tap/tokentop",
    description: "Recommended for macOS and Linux"
  },
  {
    name: "Install Script",
    command: "curl -fsSL https://raw.githubusercontent.com/tokentopapp/tokentop/main/scripts/install.sh | sh",
    description: "Works on macOS and Linux (bash/zsh)"
  },
  {
    name: "Scoop",
    command: "scoop bucket add tokentop https://github.com/tokentopapp/scoop-tokentop && scoop install tokentop",
    description: "Recommended for Windows"
  },
  {
    name: "npm",
    command: "bunx @tokentop/ttop",
    description: "Requires Bun runtime"
  }
];
---

<section id="install" class="py-24 bg-[var(--color-bg-header)] border-t border-[var(--color-border)] relative">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-16 reveal">
      <h2 class="text-3xl md:text-5xl font-bold tracking-tight mb-4">
        Get started in seconds
      </h2>
      <p class="text-lg text-[var(--color-text-muted)] max-w-2xl mx-auto">
        Install with your favorite package manager.
      </p>
    </div>

    <!-- Tabs Container -->
    <div class="bg-[var(--color-bg-card)] rounded-xl border border-[var(--color-border)] shadow-2xl overflow-hidden reveal">
      <!-- Tabs Header -->
      <div class="flex overflow-x-auto border-b border-[var(--color-border)] bg-[var(--color-bg-page)]/50 scrollbar-hide">
        {installMethods.map((method, index) => (
          <button
            class={`px-6 py-4 text-sm font-medium transition-colors whitespace-nowrap focus:outline-none border-b-2 ${index === 0 ? 'text-[var(--color-primary)] border-[var(--color-primary)] bg-[var(--color-bg-card)]' : 'text-[var(--color-text-muted)] border-transparent hover:text-[var(--color-text-primary)] hover:bg-[var(--color-bg-card)]/50'}`}
            data-tab={index}
            onclick={`switchTab(${index})`}
          >
            {method.name}
          </button>
        ))}
        <a 
          href="https://github.com/tokentopapp/tokentop/releases" 
          target="_blank" 
          class="px-6 py-4 text-sm font-medium text-[var(--color-text-muted)] border-b-2 border-transparent hover:text-[var(--color-text-primary)] hover:bg-[var(--color-bg-card)]/50 transition-colors whitespace-nowrap ml-auto"
        >
          Binaries ↗
        </a>
      </div>

      <!-- Tab Content -->
      <div class="p-6 md:p-8 bg-[var(--color-bg-card)]">
        {installMethods.map((method, index) => (
          <div class={`tab-content ${index === 0 ? 'block' : 'hidden'}`} data-content={index}>
            <div class="mb-4 text-sm text-[var(--color-text-muted)] flex items-center">
              <span class="mr-2">ℹ️</span> {method.description}
            </div>
            
            <div class="relative group">
              <div class="absolute -inset-0.5 bg-gradient-to-r from-[var(--color-primary)]/20 to-[var(--color-secondary)]/20 rounded-lg blur opacity-0 group-hover:opacity-100 transition duration-500"></div>
              <div class="relative flex items-center justify-between bg-[var(--color-bg-header)] rounded-lg px-4 py-4 border border-[var(--color-border)] shadow-inner font-mono text-sm md:text-base overflow-x-auto">
                <div class="flex items-center whitespace-nowrap mr-4">
                  <span class="text-[var(--color-success)] mr-3 select-none">$</span>
                  <code class="text-[var(--color-text-primary)] select-all">{method.command}</code>
                </div>
                <button
                  class="ml-auto text-[var(--color-text-muted)] hover:text-white transition-colors copy-btn flex-shrink-0 p-1 rounded hover:bg-[var(--color-bg-border)]"
                  data-clipboard-text={method.command}
                  aria-label="Copy to clipboard"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                  </svg>
                </button>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </div>
</section>


<script is:inline>
  function switchTab(index) {
    // Update headers
    document.querySelectorAll('[data-tab]').forEach(btn => {
      if (parseInt(btn.dataset.tab) === index) {
        btn.classList.add('text-[var(--color-primary)]', 'border-[var(--color-primary)]', 'bg-[var(--color-bg-card)]');
        btn.classList.remove('text-[var(--color-text-muted)]', 'border-transparent');
      } else {
        btn.classList.remove('text-[var(--color-primary)]', 'border-[var(--color-primary)]', 'bg-[var(--color-bg-card)]');
        btn.classList.add('text-[var(--color-text-muted)]', 'border-transparent');
      }
    });

    // Update content
    document.querySelectorAll('[data-content]').forEach(content => {
      if (parseInt(content.dataset.content) === index) {
        content.classList.remove('hidden');
        content.classList.add('block', 'animate-fade-in');
      } else {
        content.classList.add('hidden');
        content.classList.remove('block', 'animate-fade-in');
      }
    });
  }

  // Copy button logic
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.copy-btn').forEach(btn => {
      // Remove any existing listeners to prevent duplicates if other scripts attached them
      // Actually, easier to just check if it already has a listener? Hard to do.
      // We'll just rely on the fact that Hero's script is a module and this is inline.
      // But Hero's script might run before DOMContentLoaded or after.
      
      btn.addEventListener('click', () => {
        const text = btn.getAttribute('data-clipboard-text');
        if (text) {
          navigator.clipboard.writeText(text).then(() => {
            const originalHTML = btn.innerHTML;
            btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-[var(--color-success)]" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>`;
            setTimeout(() => {
              btn.innerHTML = originalHTML;
            }, 2000);
          });
        }
      });
    });
  });
</script>

